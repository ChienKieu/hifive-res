/* Copyright (C) 2013-2014 NS Solutions Corporation. Licensed under the Apache License, Version 2.0. hifive Developer Tool ver.1.0.2 gitCommitId 4cede9da492a2396cb13d5f4e98a916fcade2564 */(function(e){function ca(a){return null==a?a:e.isArray(a)?a:[a]}function P(a){h5.settings.aspects=e.map(ca(a),function(a){a.target&&(a.compiledTarget=E(a.target));a.pointCut&&(a.compiledPointCut=E(a.pointCut));return a})}function E(a){if("regexp"===e.type(a))return a;var b="",b=-1!==a.indexOf("*")?e.map(a.split("*"),function(a){return a.replace(/\W/g,"\\$&")}).join(".*"):a;return RegExp("^"+b+"$")}function F(){var a=h5.async.deferred(),b=null,c=null;if(A){var d=null;if(h5.env.ua.isIE)if(9<=h5.env.ua.browserVersion)d=
"about:blank";else{if(!window.__h5_devtool_page)return Q.error("IE8以下で使用する場合、window.__h5_devtool_pageにダミーページのパスを指定する必要があります。"),a.reject("no_dummy_page").promise();d=window.__h5_devtool_page}c=window.open(d,"1","resizable=1, menubar=no, width=910, height=700, toolbar=no, scrollbars=yes");if(!c)return a.reject("block").promise();if(c._h5devtool)return c.close(),F();try{c.document}catch(f){return c.close(),F()}var h=function(){c._h5devtool=!0;b=c.document.body;e(b).addClass("h5devtool");e(c.document.getElementsByTagName("html")).addClass("h5devtoolHTML");
c.document.title=h5.u.str.format("[devtool]{0} - hifive Developer Tool ver.{1}",window.document.title,R)};if(c.document&&"complete"===c.document.readyState)h(),a.resolve(c);else var g=null,g=setInterval(function(){c.document&&"complete"===c.document.readyState&&(clearInterval(g),h(),a.resolve(c))},100)}else c=window,b=document.body,k.append(b,"wrapper"),a.resolve(c);return a.promise()}function S(a){return a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}function T(a,b,c){var d=a.document;
if(!e(d).find("style.h5devtool-style").length||a==window){a=b;if(c)for(var f in c)h5.env.ua[f]&&(a=a.concat(c[f]));c=d.createElement("style");e(c).addClass("h5devtool-style");d.getElementsByTagName("head")[0].appendChild(c);d=d.styleSheets[d.styleSheets.length-1];if(d.insertRule)for(c=0,b=a.length;c<b;c++){var h=a[c],g=h.selector,h=h.rule,g=g+"{";for(f in h){var l=S(f),m=h[f];if(e.isArray(m))for(var n=0,k=m.length;n<k;n++)g+=l+":"+m[n]+";";else g+=l+":"+m+";"}g+="}";d.insertRule(g,d.cssRules.length)}else{var p=
!h5.env.ua.isIE||7<h5.env.ua.browserVersion;c=0;for(b=a.length;c<b;c++)for(f in h=a[c],g=h.selector,h=h.rule,h)if(l=S(f),m=h[f],p)d.addRule(g,l+":"+m);else for(var H=g.split(","),n=0,k=H.length;n<k;n++)if(e.isArray(m))for(var q=0,k=m.length;q<k;q++)d.addRule(H[n],l+":"+m[q]);else d.addRule(H[n],l+":"+m)}}}function I(a){if(!a)return""+a;if(a===J)return"関数の中身を表示できません";a=a.toString();var b=a.match(/(\t+)\}$/);return(b=b&&b[1])?a.replace(RegExp("\n"+b,"g"),"\n"):a}function U(a){if(a===window)return"window";
if(9===a.nodeType)return"document";var b=a.id,c=a.className;return a.tagName.toLowerCase()+(b&&"#"+b)+(c&&"."+c.replace(/\s/g,"."))}function V(a){var b=[],c;for(c in a){var d=a[c];h5.u.str.endsWith(c,"Controller")&&"rootController"!==c&&"parentController"!==c&&!e.isFunction(d)&&d&&!d.__controllerContext.isRoot&&b.push(c)}return b}function da(a,b){var c=e(b.rootElement),d=a.lastIndexOf(" "),d=e.trim(a.substring(0,d));if(d.match(/^\{.*\}$/)){d=e.trim(d.substring(1,d.length-1));if("rootElement"===d)return c;
a:for(var c=d,d=["window","document","navigator"],f=0,h=d.length;f<h;f++){var g=d[f];if(c===g){c=h5.u.obj.getByPath(c);break a}if(h5.u.str.startsWith(c,g+".")){c=h5.u.obj.getByPath(c);break a}}return e(c)}return c.find(d)}function K(a){function b(a,b){for(var c=b-(""+a).length,d=0;d<c;d++)a="0"+a;return a}var c=b(a.getHours(),2),d=b(a.getMinutes(),2),e=b(a.getSeconds(),2);a=b(a.getMilliseconds(),3);return h5.u.str.format("{0}:{1}:{2}.{3}",c,d,e,a)}function L(a,b,c,d,e,h){return{target:a,time:K(new Date),
cls:c,message:b,tag:d+":",promiseState:e,indentWidth:h*ea}}function u(a,b){a.push(b);a.length>v.get("LogMaxNum")&&a.shift();a.dispatchEvent({type:"logUpdate"})}function W(a,b){if(b.__controllerContext){b=e.extend(!0,{},b);for(var c in b)e.isFunction(b[c])&&b[c].toString()===X&&(b[c]=J)}a.__controllerContext.controllerDef=b;for(c in b)h5.u.str.endsWith(c,"Controller")&&"rootController"!==c&&"parentController"!==c&&b[c]&&W(a[c],b[c])}function w(){var a=h5.core.data.createObservableArray();x.push(a);
return a}function M(a){return s.getComputedStyle?s.getComputedStyle(e(a)[0],null):e(a)[0].currentStyle}function fa(a){if(Y)return e(a).outerHeight();a=M(a);return parseInt(a.height)+parseInt(a.paddingTop)+parseInt(a.paddingBottom)+parseInt(a.borderTopWidth)+parseInt(a.borderBottomWidth)+parseInt(a.marginTop)+parseInt(a.marginBottom)}function ga(a){if(Y)return e(a).outerWidth();a=M(a);return parseInt(a.width)+parseInt(a.paddingLeft)+parseInt(a.paddingRight)+parseInt(a.borderLeftWidth)+parseInt(a.borderRightWidth)+
parseInt(a.marginLeft)+parseInt(a.marginRight)}function ha(a){for(var b=e(a)[0];b&&"HTML"!==b.nodeName&&"static"===M(b).position;)b=b.offsetParent;return b||a.ownerDocument}function B(a,b){this._method={};this._callback=b;var c=a.__controllerContext?a.__controllerContext.controllerDef:a.__logicContext.logicDef,d;for(d in c)e.isFunction(c[d])&&(this._method[d]={count:0})}function p(a){if(!a)return null;a=a.__controllerContext||a.__logicContext;a.devtool=a.devtool||{};return a.devtool}function ia(a){function b(a){c.addClass("blink");
setTimeout(function(){c.removeClass("blink");a&&setTimeout(function(){b(--a)},100)},100)}var c=e(a);b(4)}function ja(a){delete y[a]}function Z(a,b,c){a.addEventListener?a.addEventListener(b,c):a.attachEvent("on"+b,c)}function $(a,b,c){var d=0,f=null;a.find("li").each(function(){if(e.trim(e(this).find(".name").text())===b)return d=this.offsetTop-this.parentNode.offsetTop,f=this,!1});f&&(a.scrollTop(d),ia(f))}if(window.h5&&!h5.devtool){var A=!0,R="1.0.2",ea=10,q=["__construct","__init","__ready","__unbind",
"__dispose"],aa=[{selector:".h5devtool",rule:{backgroundColor:"rgba(255,255,255,0.8)",height:"100%",width:"100%",margin:0,padding:0,zIndex:2E4}},{selector:".h5devtoolHTML",rule:{height:"100%",width:"100%",margin:0,padding:0,overflow:"hidden"}},{selector:".h5devtool.posfix",rule:{position:"fixed",top:0,left:0}},{selector:".h5devtool .floating-list",rule:{height:"100%",overflow:"auto"}},{selector:".h5devtool .devtool-tab",rule:{height:"100%"}},{selector:".h5devtool-upper-right",rule:{position:"fixed",
zIndex:20001,top:0,left:"810px",width:"100px",textAlign:"right"}},{selector:".h5devtool .liststyle-none",rule:{listStyle:"none"}},{selector:".h5devtool .no-padding",rule:{padding:"0!important"}},{selector:".h5devtool .font-small",rule:{fontSize:"0.8em"}},{selector:".h5devtool .trace",rule:{paddingBottom:"60px"}},{selector:".h5devtool .trace .lifecycleColor",rule:{color:"#15A2E3",borderColor:"#15A2E3"}},{selector:".h5devtool .trace .publicColor",rule:{color:"#31A120",borderColor:"#31A120"}},{selector:".h5devtool .trace .privateColor",
rule:{color:"#4A370C",borderColor:"#4A370C"}},{selector:".h5devtool .trace .eventColor",rule:{color:"#861EC2",borderColor:"#861EC2"}},{selector:".h5devtool .trace .fixedControlls label",rule:{margin:"0 2px 4px 0",borderWidth:"0 0 3px 0",borderStyle:"solid",display:"inline-block"}},{selector:".h5devtool .trace .fixedControlls",rule:{paddingLeft:0,margin:0,backgroundColor:"#fff",border:"solid 1px gray",padding:"3px",height:"60px","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box",boxSizing:"border-box"}},
{selector:".h5devtool .trace-list",rule:{paddingLeft:0,margin:0,color:"gray",whiteSpace:"nowrap"}},{selector:".h5devtool .trace-list>li.selected",rule:{backgroundColor:"#ddd"}},{selector:".h5devtool .trace-list>li .time",rule:{marginRight:"1em"}},{selector:".h5devtool .trace-list>li .tag",rule:{display:"inline-block",minWidth:"3em"}},{selector:".h5devtool .trace-list>li .promiseState",rule:{display:"inline-block",marginRight:"0.5em"}},{selector:".h5devtool .logger p",rule:{margin:"4px 0 0 2px",borderTop:"1px solid #eee",
fontSize:"12px"}},{selector:".h5devtool .logger p.TRACE",rule:{color:"#000000"}},{selector:".h5devtool .logger p.DEBUG",rule:{color:"#0000ff"}},{selector:".h5devtool .logger p.INFO",rule:{color:"#000000"}},{selector:".h5devtool .logger p.WARN",rule:{color:"#0000ff"}},{selector:".h5devtool .logger p.ERROR",rule:{color:"#ff0000"}},{selector:".h5devtool .logger p.EXCEPTION",rule:{color:"#ff0000",fontWeight:"bold"}},{selector:".h5devtool .columnLayoutWrapper",rule:{overflow:"hidden!important"}},{selector:".h5devtool .target-info .controll",
rule:{paddingLeft:"30px"}},{selector:".h5devtool .target-info .instance-detail",rule:{height:"100%"}},{selector:".h5devtool .target-info .targetlist",rule:{paddingTop:0,paddingLeft:"1.2em","*paddingLeft":0,"*position":"relative","*left":"-1.2em"}},{selector:".h5devtool .target-info .targetlist .target-name",rule:{cursor:"default"}},{selector:".h5devtool .target-info .targetlist .target-name.selected",rule:{background:"rgb(170,237,255)!important"}},{selector:".h5devtool .target-info .targetlist .target-name:hover",
rule:{background:"rgb(220,247,254)"}},{selector:".h5devtool .eventHandler .fixedController",rule:{height:"24px"}},{selector:".h5devtool .eventHandler",rule:{paddingBottom:"24px"}},{selector:".h5devtool .target-info .eventHandler ul",rule:{listStyle:"none",margin:0}},{selector:".h5devtool .target-info .eventHandler ul li .name",rule:{lineHeight:"28px"}},{selector:".h5devtool .target-info .eventHandler li.selected",rule:{background:"rgb(203,254,231)"}},{selector:".h5devtool .method .fixedController",
rule:{height:"24px"}},{selector:".h5devtool .method",rule:{paddingBottom:"24px"}},{selector:".h5devtool .method-list",rule:{listStyle:"none",margin:0,"*padding-right":"16px!important"}},{selector:".h5devtool .method-list .nocalled",rule:{background:"-webkit-gradient(linear, left top, right top, color-stop(0.95, #C3E0EF), color-stop(0.00, #F5FBFE)){-webkit-linear-gradient(left, #C3E0EF 0%, #F5FBFE 95%){-moz-linear-gradient(left, #C3E0EF 0%, #F5FBFE 95%);{-o-linear-gradient(left, #C3E0EF 0%, #F5FBFE 95%){-ms-linear-gradient(left, #C3E0EF 0%, #F5FBFE 95%){linear-gradient(left, #C3E0EF 0%, #F5FBFE 95%)".split("{")}},
{selector:".h5devtool .method-list .called",rule:{background:"-webkit-gradient(linear, left top, right top, color-stop(0.95, #6EB7DB), color-stop(0.00, #C3E0EF)){-webkit-linear-gradient(left, #6EB7DB 0%, #C3E0EF 95%){-moz-linear-gradient(left, #6EB7DB 0%, #C3E0EF 95%);{-o-linear-gradient(left, #6EB7DB 0%, #C3E0EF 95%){-ms-linear-gradient(left, #6EB7DB 0%, #C3E0EF 95%){linear-gradient(left, #6EB7DB 0%, #C3E0EF 95%)".split("{")}},{selector:".h5devtool .method-list .blink",rule:{background:"#FF9617"}},
{selector:".h5devtool .target-info .otherInfo ul",rule:{margin:0}},{selector:".h5devtool .target-info .otherInfo dt",rule:{fontWeight:"bold",margin:"5px 0 5px 5px"}},{selector:".h5devtool .method-list .count",rule:{"float":"right",fontWeight:"bold",fontSize:"30px",position:"relative",top:"16px",right:"10px",color:"#888"}},{selector:".h5devtool .method-list pre",rule:{margin:"0 0 10px",padding:"4px",wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre",whiteSpace:"pre-wrap",background:"rgb(250,250,250)",
border:"1px solid rgb(213,213,213)","-webkit-border-radius":"4px","-moz-border-radius":"4px",borderRadius:"4px",fontFamily:'Monaco,Menlo,Consolas,"Courier New",monospace',fontSize:"12px"}},{selector:".h5devtool .target-info .detail",rule:{overflow:"auto"}},{selector:".h5devtool .ovfAuto",rule:{overflow:"auto"}},{selector:".h5devtool .ovfHidden",rule:{overflow:"hidden"}},{selector:".h5devtool .left",rule:{"float":"left",height:"100%",maxWidth:"350px",border:"1px solid #20B5FF","-moz-box-sizing":"border-box",
"-webkit-box-sizing":"border-box",boxSizing:"border-box","*position":"absolute","*height":"auto","*top":0,"*left":0,"*bottom":0,"*width":"350px"}},{selector:".h5devtool .right",rule:{height:"100%",border:"1px solid #20B5FF",borderLeft:"none","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box",boxSizing:"border-box","*position":"absolute","*height":"auto","*width":"auto","*top":0,"*left":"350px","*right":0,"*bottom":0}},{selector:".h5devtool .eventHandler .menu",rule:{display:"none"}},
{selector:".h5devtool .eventHandler .menu>*",rule:{display:"inline-block"}},{selector:".h5devtool .eventHandler .selected .menu",rule:{display:"inline-block"}},{selector:".h5devtool ul.nav-tabs",rule:{listStyle:"none",width:"100%",margin:0,padding:0,"float":"left"}},{selector:".h5devtool ul.nav-tabs>li",rule:{"float":"left",padding:"3px",border:"1px solid #ccc",color:"#20B5FF",marginLeft:"-1px",cursor:"pointer"}},{selector:".h5devtool ul.nav-tabs>li.active",rule:{color:"#000",borderBottom:"none"}},
{selector:".h5devtool .tab-content",rule:{marginTop:"-1px",width:"100%",height:"100%",paddingBottom:"30px","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box",boxSizing:"border-box","*position":"absolute","*height":"auto","*top":"26px","*left":0,"*bottom":0,"*right":"20px","*paddingBottom":0,"*overflow-y":"auto","*overflow-x":"hidden"}},{selector:".h5devtool .tab-content>*",rule:{overflow:"auto","float":"left",height:"inherit",width:"100%",paddingLeft:0,margin:0,height:"100%","-moz-box-sizing":"border-box",
"-webkit-box-sizing":"border-box",boxSizing:"border-box"}},{selector:".h5devtool .tab-content>*.hasfix",rule:{overflow:"visible!important"}},{selector:".h5devtool .tab-content>*",rule:{display:"none"}},{selector:".h5devtool .tab-content>.active",rule:{display:"block"}},{selector:".h5devtool .dropdown-menu",rule:{position:" absolute",top:"100%",left:"0","z-index":"1000",display:"none","float":"left","min-width":"160px",padding:"5px 0",margin:"2px 0 0","list-style":"none","background-color":"#fff",
border:"1px solid #ccc",border:"1px solid rgba(0,0,0,0.2)","-webkit-border-radius":"6px","-moz-border-radius":"6px","border-radius":"6px","-webkit-box-shadow":"0 5px 10px rgba(0,0,0,0.2)","-moz-box-shadow":"0 5px 10px rgba(0,0,0,0.2)","box-shadow":"0 5px 10px rgba(0,0,0,0.2)","-webkit-background-clip":"padding-box","-moz-background-clip":"padding","background-clip":"padding-box"}},{selector:".h5devtool .dropdown-menu li",rule:{fontSize:"0.8em",padding:"8px",cursor:"pointer"}},{selector:".h5devtool .dropdown-menu li:hover",
rule:{backgroundColor:"#eee"}}],ka={selector:".h5devtool .trace-list>li",rule:{lineHeight:"2em"}},la={},ma=[{selector:".h5devtool-overlay, .h5devtool-overlay *",rule:{position:"absolute",zIndex:1E4,"-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box",boxSizing:"border-box"}},{selector:".h5devtool-overlay .body",rule:{height:"100%",width:"100%",opacity:"0.2",filter:"alpha(opacity=20)",backgroundColor:"rgb(64, 214, 255)"}},{selector:".h5devtool-overlay.event-target .body",rule:{backgroundColor:"rgb(128,255,198)"}},
{selector:".h5devtool-overlay .border",rule:{opacity:"0.3",filter:"alpha(opacity=30)",position:"absolute",borderTopWidth:"3px",borderLeftWidth:"3px",borderBottomWidth:0,borderRightWidth:0}},{selector:".h5devtool-overlay.root .border",rule:{borderStyle:"solid",borderColor:"rgb(64, 214, 255)"}},{selector:".h5devtool-overlay.child .border",rule:{borderStyle:"dashed",borderColor:"rgb(64, 214, 255)"}},{selector:".h5devtool-overlay.event-target .border",rule:{borderStyle:"dashed",borderColor:"rgb(128,255,198)"}},
{selector:".h5devtool-overlay.borderOnly .body",rule:{display:"none"}},{selector:".h5devtool-overlay.borderOnly",rule:{height:"0!important",width:"0!important"}}],k=h5.core.view.createView();k.register("wrapper",'<div class="h5devtool-upper-right"><div class="h5devtool-controllBtn showhideBtn hideTool">↑</div><div class="h5devtool-controllBtn opencloseBtn closeTool">×</div></div><div class="h5devtool posfix" style="position:fix; left:0; top:0;"></div>');k.register("devtool-tab",'<div class="devtool-tab"><ul class="nav nav-tabs root-nav"><li class="active" data-tab-page="controller-info">コントローラ</li><li data-tab-page="logic-info">ロジック</li><li data-tab-page="trace">トレース</li><li data-tab-page="logger">ロガー</li><li data-tab-page="settings">設定</li></ul><div class="tab-content"><div class="active controller-info target-info columnLayoutWrapper"></div><div class="logic-info target-info columnLayoutWrapper"></div><div class="trace whole hasfix"></div><div class="logger"></div><div class="settings"></div></div>');
k.register("targetListInfoWrapper",'<div class="left ovfAuto"></div><div class="right ovfHidden"></div>');k.register("target-list",'<ul class="targetlist"></ul>');k.register("target-list-part",'<li><span class="target-name [%= cls %]">[%= name %]</span></li>');k.register("method-list",'<div class="fixedControlls"><select class="method-select"></select></div><ul class="liststyle-none no-padding method-list floating-list">[% for(var i = 0, l = methods.length; i < l; i++){ var p = methods[i];%]<li class="[%= (methodCount.get(p)?"called":"nocalled") %]"><span class="name">[%= p %]</span><span class="count">[%= methodCount.get(p) %]</span><pre class="value">[%= _funcToStr(defObj[p]) %]</pre></li>[% } %]</ul>');
k.register("trace",'<div class="fixedControlls"><label class="event eventColor"><input type="checkbox" checked name="event"/>イベント</label><label class="public publicColor"><input type="checkbox" checked name="public" />パブリック</label><label class="private privateColor"><input type="checkbox" checked name="private" />プライベート</label><label class="lifecycle lifecycleColor"><input type="checkbox" checked name="lifecycle"/>ライフサイクル</label><br><input type="text" class="filter"/><button class="filter-show">絞込み</button><button class="filter-hide">除外</button><button class="filter-clear" disabled>フィルタ解除</button><span class="font-small">（ログを右クリックまたはタッチで関数にジャンプ）</span></div><ul class="trace-list liststyle-none no-padding floating-list" data-h5-loop-context="logs"></ul><ul class="contextMenu logContextMenu dropdown-menu"><li class="showFunction"><span>関数を表示</span></li></ul>');
k.register("trace-list-part",'<li class=[%= cls %]><span class="time">[%= time %]</span><span style="margin-left:[%= indentWidth %]px" class="tag">[%= tag %]</span><span class="promiseState">[%= promiseState %]</span><span class="message [%= cls %] [%= cls %]Color">[%= message %]</span></li>');k.register("controller-detail",'<div class="detail instance-detail controller-detail"><ul class="nav nav-tabs"><li class="active" data-tab-page="eventHandler">イベントハンドラ</li><li data-tab-page="method">メソッド</li><li data-tab-page="trace">トレース</li><li data-tab-page="otherInfo">その他情報</li></ul><div class="tab-content"><div class="active eventHandler hasfix"></div><div class="method hasfix"></div><div class="trace hasfix"></div><div class="otherInfo"></div></div>');
k.register("eventHandler-list",'<div class="fixedControlls">[% if(eventHandlers.length){ %]<select class="method-select"></select></div><ul class="liststyle-none no-padding method-list floating-list">[% for(var i = 0, l = eventHandlers.length; i < l; i++){ var p = eventHandlers[i]; %]<li class="[%= (methodCount.get(p)?"called":"nocalled") %]"><span class="menu">ターゲット:<select class="eventTarget"></select><button class="trigger">実行</button></span><span class="name">[%= p %]</span><span class="count">[%= methodCount.get(p) %]</span><pre class="value">[%= _funcToStr(controller[p]) %]</pre></li>[% } %]</ul>[% } else { %]<p>なし</p>[% } %]');
k.register("controller-otherInfo",'<dl><dt>名前</dt><dd>[%= controller.__name %]</dd><dt> ルートコントローラか</dt><dd>[%= controller.__controllerContext.isRoot %]</dd><dt>ルート要素</dt><dd>[%= _formatDOM(controller.rootElement)  %]</dd><dt>ルートコントローラ</dt><dd>[%= controller.rootController.__name %]</dd><dt>親コントローラ</dt><dd>[%= controller.parentController && controller.parentController.__name || "なし" %]</dd><dt>子コントローラ一覧</dt><dd>[% if(!childControllerNames.length){ %]なし[% }else{ %]<ul class="no-padding">[% for(var i = 0, l = childControllerNames.length; i < l; i++){ %]<li>[%= childControllerNames[i] %]</li>[% } %]</ul>[% } %]</dd><dt>テンプレートパス一覧</dt><dd>[% if(!controller.__templates){ %]なし[% }else{ %]<ul class="no-padding">[% var templates = typeof controller.__templates === "string"? [controller.__templates]: controller.__templates; for(var i = 0, l = templates.length; i < l; i++){ %]<li>[%= templates[i] %]</li>[% } %]</ul>[% } %]</dd><dt>このコントローラで登録されたテンプレートID一覧</dt><dd>[% if(registedTemplates.length === 0){ %]なし[% }else{ %][%= registedTemplates.join(", ") %][% } %]</dd><dt>利用可能なテンプレートID一覧</dt><dd>[% if(availableTemplates.length === 0){ %]なし[% }else{ %][%= availableTemplates.join(", ") %][% } %]</dd></dl>');
k.register("logic-detail",'<div class="detail instance-detail logic-detail"><ul class="nav nav-tabs"><li class="active" data-tab-page="method">メソッド</li><li data-tab-page="trace">トレース</li><li data-tab-page="otherInfo">その他情報</li></ul><div class="tab-content"><div class="active method hasfix"></div><div class="trace hasfix"></div><div class="otherInfo"></div></div>');k.register("logic-otherInfo","<dl><dt>名前</dt><dd>[%= defObj.__name %]</dd><dt>ロジックインスタンスの名前</dt><dd>[%= instanceName %]</dd></dl>");k.register("overlay",
'<div class="h5devtool-overlay [%= cls %]"><div class="body"></div><div class="border top"></div><div class="border right"></div><div class="border bottom"></div><div class="border left"></div></div>');k.register("settings",'<label for="h5devtool-setting-LogMaxNum">ログの最大表示件数</label><input type="text" id="h5devtool-setting-LogMaxNum" data-h5-bind="attr(value):LogMaxNum" name="LogMaxNum"/><button class="set">設定</button>');var Q=h5.log.createLogger("h5.devtool"),s=null,N=!1,v=h5.core.data.createObservableItem({LogMaxNum:{type:"integer",
defaultValue:1E3,constraint:{notNull:!0,min:0}}}),x=[],O=w(),C=0,D=w(),J=function(){},X="",r={target:"h5.devtool.dummyController",pointCut:"f",interceptors:J};P(r);h5.settings.aspects=[r];h5.core.controller(document,{__name:"h5.devtool.dummyController",f:function(){}}).initPromise.done(function(){X=this.f.toString();this.dispose()});h5.settings.aspects=null;var Y=!h5.env.ua.isIE||!/(^2\..*)|(^1\.8|9|(10)\..*)/.test(e().jquery),y={};e.extend(B.prototype,{count:function(a){var b=++this._method[a].count;
this._callback&&this._callback(a);return b},get:function(a){return this._method[a].count},registerCallback:function(a){this._callback=a},removeCallback:function(){this._callback=null}});h5.core.expose({__name:"h5.devtool.ui.ContextMenuController",_contextMenu:null,contextMenuExp:"",targetAll:!0,__construct:function(a){a.args&&(void 0!=a.args.targetAll&&(this.targetAll=a.args.targetAll),void 0!=a.args.contextMenuExp&&(this.contextMenuExp=a.args.contextMenuExp))},__ready:function(a){var b=e(this.rootElement),
c=b.attr("data-targetall");void 0!=c&&(/false/i.test(c)&&(c=!1),this.targetAll=!!c);void 0!=b.attr("data-contextmenuexp")&&(this.contextMenuExp=a.args.contextMenuExp);this.close()},_getContextMenu:function(a){return this.$find("> .contextMenu"+(a||this.contextMenuExp))},close:function(a){var b=this.$find("> .contextMenu");b.hasClass("open")&&(this.trigger("selectMenuItem",{selected:a?a:null}),b.css({display:"none"}),b.removeClass("open"),this.trigger("hideCustomMenu"))},_open:function(a,b){function c(a,
b,d){a.find("> .dropdown-submenu > .dropdown-menu").each(function(){var a=e(this),f,g=a[0].style.display;a.css({display:"block"});f=a.outerWidth(!0);f>r-b?(a.parent().addClass("pull-left"),f=b-f):(a.parent().removeClass("pull-left"),f=b+f);var h=a.parent(),l=d+h.position().top,k=a.outerHeight(!0);k>t-l?(l=l-k+h.height(),a.css({top:"auto",bottom:"0"})):a.css({top:"0",bottom:"auto"});c(a,f,l);a.css({display:g})})}function d(a){var b="CSS1Compat"!==document.compatMode?document.body:document.documentElement;
return h5.env.ua.isiOS?window["inner"+a]:b["client"+a]}function f(a){var b="CSS1Compat"!==document.compatMode;return function(){var c=b?document.body:document.documentElement;return window["page"+("Top"===a?"Y":"X")+"Offset"]||c["scroll"+a]}}var h=this._getContextMenu(b);if(h.hasClass("open")||!this.trigger("showCustomMenu",{orgContext:a}).isDefaultPrevented()){h.css({display:"block",visibility:"hidden",left:0,top:0});h.addClass("open");var g,l;a.event.originalEvent.targetTouches?(l=a.event.originalEvent.targetTouches[0],
g=l.pageX,l=l.pageY):(g=a.event.pageX,l=a.event.pageY);var m=ha(h),m=e(m).offset();g-=m.left;l-=m.top;var m=ga(h),k=fa(h),G=f("Left")(),p=f("Top")(),q=d("Width"),s=d("Height"),r=G+q,t=p+s,q=g+m;q>r&&(g=r-m,g<G&&(g=G));l+k>t&&(l-=k,l<p&&(l=p));c(h,q,l);h.css({visibility:"visible",left:g,top:l})}},_filter:null,setFilter:function(a){null==a?this._filter=null:e.isFunction(a)?this._filter=a:"string"===typeof a&&(this._filter=function(b){if(e(b.event.target).filter(a).length)return!1})},".trace-list>li>* touchstart":function(a){this._contextmenu(a)},
"{rootElement} contextmenu":function(a){this._contextmenu(a)},"{document.body} click":function(a){this.close()},"{document.body} contextmenu":function(a){this.close()},".contextMenuBtn contextmenu":function(a){a.event.preventDefault();a.event.stopPropagation();var b=e(a.event.currentTarget).attr("data-contextmenuexp");this._open(a,b)},"> .contextMenu .dropdown-menu click":function(a){a.event.stopPropagation();this.close()},"> .contextMenu li a click":function(a){a.event.stopPropagation();this.close(a.event.target)},
_contextmenu:function(a){this.close();this._filter&&!1===this._filter(a)||!this.targetAll||(a.event.preventDefault(),a.event.stopPropagation(),this._open(a))}});h5.core.expose({__name:"h5.devtool.ControllerAndLogicInfoController",win:null,$info:null,selectedTarget:null,_methodCountMap:{},__init:function(){if(!this.__controllerContext.controllerDef)for(var a=h5.core.controllerManager.getAllControllers(),b=0,c=a.length;b<c;b++)W(a[b],a[b])},__ready:function(a){this.win=a.args.win;T(this.win,h5.env.ua.isDesktop?
aa:aa.concat(ka),la);T(window,ma);k.append(this.$find(".left"),"target-list");this.$find(".right>.detail").css("display","none");a=h5.core.controllerManager.getAllControllers();for(var b=0,c=a.length;b<c;b++)this.appendTargetToList(a[b])},"{.h5devtool} close":function(){this.removeOverlay(!0)},"{.h5devtool} leftclick":function(){this.unfocus()},"{window.opener.document} h5controllerunbound":function(a){this.removeTargetList(a.evArg)},".targetlist .target-name mouseover":function(a,b){var c=this.getTargetFromElem(b);
this.removeOverlay();c.__name&&c.__controllerContext&&b.data("h5devtool-overlay",this.overlay(c.rootElement,c.__controllerContext.isRoot?"root":"child"))},".targetlist .target-name mouseout":function(a,b){this.removeOverlay()},".targetlist .target-name click":function(a,b){if(!b.hasClass("selected")){var c=this.getTargetFromElem(b);this.$find(".target-name").removeClass("selected");b.addClass("selected");this.setTarget(c);if(c=b.data("h5devtool-overlay"))this.removeOverlay(!0,c),e(".h5devtool-overlay").addClass("borderOnly")}},
setTarget:function(a){this.selectedTarget=a;this.setDetail(a)}," .eventHandler li:not(.selected) mouseover":function(a,b){this.selectEventHandler(b)},".eventHandler li:not(.selected) click":function(a,b){this.selectEventHandler(b)}," .eventHandler li.selected mouseleave":function(a,b){this.selectEventHandler(null)},selectEventHandler:function(a){this.$find(".eventHandler li").removeClass("selected");this.removeOverlay();if(null!=a){a.addClass("selected");var b=this.getTargetFromElem(this.$find(".target-name.selected")),
c=e.trim(a.find(".name").text()),b=da(c,b);a.data("h5devtool-eventTarget",b);this.overlay(b,"event-target");var d=a.closest("li").find("select.eventTarget").html("");b.length?b.each(function(){var a=e(s.document.createElement("option"));a.data("h5devtool-eventTarget",this);a.text(U(this));d.append(a)}):(a=e(s.document.createElement("option")),a.text("該当なし"),d.append(a),d.attr("disabled","disabled"))}}," .eventHandler .trigger click":function(a,b){var c=e.trim(b.closest("li").find(".name").text()).match(/ (\S+)$/)[1],
d=b.closest(".menu").find("option:selected").data("h5devtool-eventTarget");d?e(d).trigger(c):alert("イベントターゲットがありません")},".method-select change":function(a,b){var c=b.val(),d=b.parents(".active").eq(0).find(".method-list");$(d,c,!0)},"{.h5devtool} tabChange":function(a){"eventHandler"!==a.evArg&&(this.removeOverlay(),this.$find(".eventHandler li").removeClass("selected"))},_clearDetailView:function(){for(var a=h5.core.controllerManager.getControllers(this.$find(".right"),{deep:!0}),b=0,c=a.length;b<
c;b++)a[b].dispose();this.$find(".right").html("")},setDetail:function(a){this._clearDetailView();if(null!=a){var b=p(a);b.methodCount._method||(b.methodCount._method=new B(a));a.__controllerContext?this._showControllerDetail(a):this._showLogicDetail(a)}},_showControllerDetail:function(a){k.update(this.$find(".right"),"controller-detail");var b=[],c=[],d=p(a),f;for(f in d.methodCount._method)-1===f.indexOf(" ")?b.push(f):c.push(f);b.sort(function(a,b){if(-1!==e.inArray(a,q)&&-1!==e.inArray(b,q))return e.inArray(a,
q)-e.inArray(b,q);var c;c=0-(0<=e.inArray(a,q)?1:0);c+=0<=e.inArray(b,q)?1:0;c-=h5.u.str.startsWith(a,"_")&&-1===e.inArray(a,q)?-1:0;c+=h5.u.str.startsWith(b,"_")&&-1===e.inArray(b,q)?-1:0;return 0===c?a>b?1:-1:c});this._updateEventHandlerView({id:d.id,controller:a.__controllerContext.controllerDef,eventHandlers:c,_funcToStr:I,methodCount:d.methodCount});this._updateMethodView({id:d.id,defObj:a.__controllerContext.controllerDef,methods:b,_funcToStr:I,methodCount:d.methodCount});b=d.devtoolLog;h5.core.controller(this.$find(".instance-detail .trace"),
h5.devtool.TraceLogController,{traceLogs:b,infoCtrls:[this]});for(var c=V(a),b=[],d=0,h=c.length;d<h;d++)b.push(a[c[d]].__name);c=[];for(f in a.view.__view.__cachedTemplates)-1===e.inArray(f,c)&&c.push(f);for(var d=[],h=a,g=h.view.__view;;){var l=g.__cachedTemplates;for(f in l)-1===e.inArray(f,d)&&d.push(f);if(g===h5.core.view)break;h.parentController?(h=h.parentController,g=h.view.__view):g=h5.core.view}k.update(this.$find(".instance-detail .tab-content .otherInfo"),"controller-otherInfo",{controller:a,
childControllerNames:b,_formatDOM:U,availableTemplates:d,registedTemplates:c})},_updateEventHandlerView:function(a){var b=this.$find(".instance-detail .tab-content .eventHandler");k.update(b,"eventHandler-list",a);for(var c=b.find(".method-select"),d=0,f=a.eventHandlers.length;d<f;d++)c.append(h5.u.str.format('<option value="{0}">{0}</option>',a.eventHandlers[d]));var h=this._methodCountMap,g=a.id;b.find(".method-list>*").each(function(){var a=e(this);h[g+"#"+a.find(".name").text()]=a.find(".count")});
this._registerMethodCountCallback(y[a.id],a.methodCount)},_updateMethodView:function(a){var b=this.$find(".instance-detail .tab-content .method");k.update(b,"method-list",a);for(var c=b.find(".method-select"),d=0,f=a.methods.length;d<f;d++)c.append(h5.u.str.format('<option value="{0}">{0}</option>',a.methods[d]));var h=this._methodCountMap,g=a.id;b.find(".method-list>*").each(function(){var a=e(this);h[g+"#"+a.find(".name").text()]=a.find(".count")});this._registerMethodCountCallback(y[a.id],a.methodCount)},
".detail>.nav-tabs>.active click":function(a,b){if("method"===b.data("tab-page")||"eventHandler"===b.data("tab-page")){var c=this.getTargetFromElem(this.$find(".target-name.selected"));this.setDetail(c)}},_showLogicDetail:function(a){k.update(this.$find(".right"),"logic-detail");var b=[],c=[],d;for(d in a.__logicContext.logicDef)e.isFunction(a.__logicContext.logicDef[d])&&(h5.u.str.startsWith(d,"_")?b.push(d):c.push(d));b.sort();c.sort();c=c.concat(b);b=p(a);d=this.$find(".instance-detail .tab-content .method");
this._updateMethodView({id:b.id,defObj:a.__logicContext.logicDef,methods:c,_funcToStr:I,methodCount:b.methodCount});var f=this._methodCountMap,h=b.id;d.find(".method-list>*").each(function(){var a=e(this);f[h+"#"+a.find(".name").text()]=a.find(".count")});this._registerMethodCountCallback(a,b.methodCount);c=b.devtoolLog;h5.core.controller(this.$find(".instance-detail .trace"),h5.devtool.TraceLogController,{traceLogs:c,infoCtrls:[this]});k.update(this.$find(".instance-detail .tab-content .otherInfo"),
"logic-otherInfo",{defObj:a.__logicContext.logicDef,instanceName:b.instanceName||"なし(このインスタンスがルートロジックです)"})},_registerMethodCountCallback:function(a,b){b.registerCallback(this.own(function(c){if(a.__name&&this.selectedTarget===a){var d=p(a).id,d=this._methodCountMap[d+"#"+c];d.text(b.get(c));d.parent().addClass("called")}}))},setTargetToElem:function(a,b){e(a).data("h5devtool-targetId",p(b).id)},getTargetFromElem:function(a){a=e(a).data("h5devtool-targetId");return y[a]},unfocus:function(){this.setDetail(null);
this.$find(".target-name").removeClass("selected");this.removeOverlay(!0)},overlay:function(a,b){var c=(e.isArray(b)?b:[b]).join(" "),d=e(a),f=e();d.each(function(){var a=e(k.get("overlay",{cls:c})),b=e(this).outerWidth(),d=e(this).outerHeight(),m=e(this).offset()||{top:0,left:0};a.css({width:b,height:d,top:m.top,left:m.left});var m=a.find(".border.top"),n=a.find(".border.right"),p=a.find(".border.bottom"),q=a.find(".border.left");m.css({top:0,left:0,width:b,height:3});n.css({top:0,left:b,width:3,
height:d});p.css({top:d,left:0,width:b,height:3});q.css({top:0,left:0,width:3,height:d});e(window.document.body).append(a);f=f.add(a)});return f},removeOverlay:function(a,b){var c=a?e(".h5devtool-overlay"):e(".h5devtool-overlay:not(.borderOnly)");(b?c.not(b):c).remove()},appendTargetToList:function(a,b){if(!h5.u.str.startsWith(a.__name,"h5.devtool")){var c=p(a),d=a.__name+"_"+(new Date).getTime()+"_"+parseInt(1E3*Math.random());y[d]=a;p(a).id=d;b=b||this.$find(".targetlist:first");c.devtoolLog||(c.devtoolLog=
w());c.methodCount=c.methodCount||new B(a);if(a.__controllerContext){if(c=e(k.get("target-list-part",{name:a.__name,cls:a.__controllerContext.isRoot?"root":"child"}),b[0].ownerDocument),this.setTargetToElem(c.children(".target-name"),a),b.append(c),d=V(a),d.length)for(var f=0,h=d.length;f<h;f++){var g=d[f],l=a[g];l.__controllerContext.devtool=l.__controllerContext.devtool||{};l.__controllerContext.devtool.instanceName=a.__name+"#"+g;k.append(c,"target-list");this.appendTargetToList(l,c.find("ul:last"))}}else a.__logicContext.devtool=
a.__logicContext.devtool||{name:a.__name,devtoolLog:w()},c=e(k.get("target-list-part",{name:a.__name,cls:"root"}),b[0].ownerDocument),this.setTargetToElem(c.children(".target-name"),a),b.append(c);d=!1;for(g in a)h5.u.str.endsWith(g,"Logic")&&a[g]&&!e.isFunction(a[g])&&(d||(k.append(c,"target-list"),d=!0),a[g].__logicContext.devtool=a[g].__logicContext.devtool||{},a[g].__logicContext.devtool.instanceName=a.__name+"#"+g,this.appendTargetToList(a[g],c.find("ul:last")))}},removeTargetList:function(a){var b=
this.$find(".selected");a===this.getTargetFromElem(b)&&this.unfocus();var c=this;this.$find(".targetlist .target-name").each(function(){if(c.getTargetFromElem(this)===a)return e(this).closest("li").remove(),!1});ja(p(a).id)}});h5.core.expose({__name:"h5.devtool.SettingsController",__ready:function(){k.bind(this.rootElement,v);v.addEventListener("change",function(a){for(var b in a.props){var c=a.props[b].newValue;switch(b){case "LogMaxNum":for(var d=0,e=x.length;d<e;d++)c>=x[d].length||x[d].splice(0,
x[d].length-c)}}})},".set click":function(){var a={};this.$find("input").each(function(){a[this.name]=this.value});v.validate(a)?s.alert("ログの最大表示件数は0以上の整数値で入力してください"):v.set(a)}});r={__name:"h5.devtool.BaseLogController",_contextMenuController:h5.devtool.ui.ContextMenuController,_isScrollLast:!1,_logArray:null,_createLogHTML:function(){},_selectLogObject:null,__ready:function(a){this._contextMenuController.contextMenuExp=".logContextMenu";this._contextMenuController.setFilter("*:not(.trace-list>li>*)")},
setLogArray:function(a,b){a._viewBindTarget=b;this._logArray=a;a.addEventListener("logUpdate",this.own(this._update));this._logArray.length&&this._updateView();e(b).bind("scroll",this.ownWithOrg(function(a,b){this._isScrollLast=a.scrollTop>a.scrollHeight-a.clientHeight-30}))},setCreateLogHTML:function(a){this._createLogHTML=a},_update:function(){if(e(this.rootElement).hasClass("active")){var a=this._logArray;a._logUpdatedInMaxDelay=!0;a._logDelayTimer&&clearTimeout(a._logDelayTimer);a._logDelayTimer=
setTimeout(this.own(function(){this._updateView()}),100)}},_updateView:function(){if(this.__name){var a=this._logArray;clearTimeout(a._logDelayTimer);clearTimeout(a._logMaxDelayTimer);a._logDelayTimer=null;a._logMaxDelayTimer=null;var b=a._viewBindTarget;b&&(b.innerHTML=this._createLogHTML(a));this._isScrollLast&&(b.scrollTop=b.scrollHeight-b.clientHeight);a._logUpdatedInMaxDelay=!1;a._logMaxDelayTimer=setTimeout(this.own(function(){a._logUpdatedInMaxDelay&&this._updateView()}),500)}},"{rootElement} tabSelect":function(){this._updateView()},
"{rootElement} showCustomMenu":function(a){this._unselect();a=e(a.evArg.orgContext.event.target).closest("li");a.addClass("selected");this._selectLogObject=this._logArray.get(a.attr("data-h5devtool-logindex"))},"{rootElement} hideCustomMenu":function(a){this._unselect()},_unselect:function(){this.$find(".trace-list>li").removeClass("selected")},".showFunction click":function(a,b){for(var c=this._selectLogObject.target,d=this.parentController.infoCtrls,f=null,h=!1,g=0,k=d.length;g<k&&!h;g++){var m=
d[g];m.$find(".target-name").each(function(){if(m.getTargetFromElem(this)===c)return e(this).trigger("mouseover"),e(this).trigger("click"),h=!0,f=m,!1})}if(f){e(f.rootElement).hasClass("controller-info")?e(s.document.body).find(".root-nav").find('*[data-tab-page="controller-info"]').trigger("click"):e(f.rootElement).hasClass("logic-info")&&e(s.document.body).find(".root-nav").find('*[data-tab-page="logic-info"]').trigger("click");var n=this._selectLogObject.message;setTimeout(function(){var a=e.trim(n.slice(n.indexOf("#")+
1)),b=-1!==a.indexOf(" ")&&c.__controllerContext?"eventHandler":"method",d=f.$find('.instance-detail>.nav-tabs>*[data-tab-page="'+b+'"]');d.hasClass("active")||d.trigger("click");b=f.$find(".instance-detail ."+b+" .method-list");$(b,a,!0)},0)}}};h5.core.expose(r);h5.core.expose({__name:"h5.devtool.TraceLogController",_condition:{filterStr:"",exclude:!1,hideCls:{}},baseController:r,infoCtrls:[],__ready:function(a){k.update(this.rootElement,"trace");this.baseController.setCreateLogHTML(this.own(this._createLogHTML));
this.baseController.setLogArray(a.args.traceLogs,this.$find(".trace-list")[0]);a.args.infoCtrls&&this.setInfoControllers(a.args.infoCtrls)},setInfoControllers:function(a){this.infoCtrls=a},_createLogHTML:function(a){for(var b=this._condition.filterStr,c=this._condition.filterReg,d=this._condition.filterStr&&this._condition.exclude,f=this._condition.hideCls,h="",g=0,l=a.length;g<l;g++){var m=a.get(g),n=k.get("trace-list-part",m),n=e(n).attr("data-h5devtool-logindex",g)[0].outerHTML;!d===!(c?m.message.match(c):
-1!==m.message.indexOf(b))?h+=e(n).css("display","none")[0].outerHTML:(f&&f[m.cls]&&(n=e(n).css("display","none")[0].outerHTML),h+=n)}return h},'input[type="checkbox"] change':function(a,b){var c=b.attr("name");b.prop("checked")?this._condition.hideCls[c]=!1:this._condition.hideCls[c]=!0;this.refresh()},"input.filter keydown":function(a){13===a.event.keyCode&&(a=this.$find("input.filter").val())&&(this._executeFilter(a),this.$find(".filter-clear").prop("disabled",!1))},"input.filter keyup":function(a){""===
this.$find("input.filter").val()&&this._executeFilter("")},"button.filter-show click":function(a){if(a=this.$find("input.filter").val())this._executeFilter(a),this.$find(".filter-clear").prop("disabled")},"button.filter-hide click":function(a){if(a=this.$find("input.filter").val())this._executeFilter(a,!0),this.$find(".filter-clear").prop("disabled")},"button.filter-clear click":function(a){this._executeFilter("");this.$find(".filter-clear").prop("disabled",!0)},_executeFilter:function(a,b){this._condition.filterStr=
a;this._condition.filterReg=-1!==a.indexOf("*")?E(a):null;this._condition.exclude=!!b;this.refresh()},refresh:function(){this.$find(".trace-list")[0].innerHTML=this._createLogHTML(this.baseController._logArray)}});h5.core.expose({__name:"h5.devtool.LoggerController",baseController:h5.devtool.BaseLogController,_logArray:null,__ready:function(a){this.baseController.setCreateLogHTML(this.own(this._createLogHTML));this.baseController.setLogArray(a.args.loggerArray,this.rootElement);this._onnerrorHandler=
this.own(function(a){D.push({levelString:"EXCEPTION",date:new Date,args:["{0} {1}:{2}",a.originalEvent.message,a.originalEvent.fileName||"",a.originalEvent.lineno||""]});this.baseController._updateView()});e(window).bind("error",this._onnerrorHandler)},_createLogHTML:function(a){for(var b="",c=0,d=a.length;c<d;c++)var e=a.get(c),h="["+e.levelString+"]"+K(e.date)+" "+h5.u.str.format.apply(h5.u.str,e.args),b=b+('<p class="'+e.levelString+'">'+h+"</p>");return b},__unbind:function(){e(window).unbind("error",
this._onnerrorHandler)}});h5.core.expose({__name:"h5.devtool.TabController",__ready:function(){this.$find("tab-content").not(".active").css("display","none")},selectTab:function(a){this.$find(".nav-tabs li."+a).trigger("click")},".nav-tabs li click":function(a,b){if(!b.hasClass("active")){b.parent().find(">.active").removeClass("active");b.addClass("active");var c=b.data("tab-page"),d=b.closest(".nav-tabs").next();d.find(">.active").removeClass("active");d=d.find(">."+c);d.addClass("active");this.trigger("tabChange",
c);d.trigger("tabSelect")}}});var ba={__name:"h5.devtool.DevtoolController",win:null,targetWindow:window,_controllerInfoController:h5.devtool.ControllerAndLogicInfoController,_logicInfoController:h5.devtool.ControllerAndLogicInfoController,_tabController:h5.devtool.TabController,_traceLogController:h5.devtool.TraceLogController,_loggerController:h5.devtool.LoggerController,_settingsController:h5.devtool.SettingsController,__meta:{_controllerInfoController:{},_logicInfoController:{},_traceLogController:{},
_settingsController:{},_loggerController:{}},_boundLogics:[],_logicboundEventBound:!1,__construct:function(a){this.win=a.args.win;k.append(this.rootElement,"devtool-tab");k.append(this.$find(".controller-info"),"targetListInfoWrapper");k.append(this.$find(".logic-info"),"targetListInfoWrapper");k.append(this.$find(".settings"),"settings");this.__meta._controllerInfoController.rootElement=this.$find(".controller-info");this.__meta._logicInfoController.rootElement=this.$find(".logic-info");this.__meta._traceLogController.rootElement=
this.$find(".trace");this.__meta._loggerController.rootElement=this.$find(".logger");this.__meta._settingsController.rootElement=this.$find(".settings");h5.settings.log={target:{view:{type:{log:function(a){var b=a.args;b[1]&&"string"===typeof b[1]&&0===b[1].indexOf("h5.devtool.")||(D.push(a),D.dispatchEvent({type:"logUpdate"}))}}}},out:[{category:"*",targets:["view"]}]};h5.log.configure();var b=h5.core.logic,c=this;h5.core.logic=function(a){a=b(a);c._logicboundEventBound?e(window.document).trigger("h5devtoolLogicbound",
a):c._boundLogics.push(a);return a}},__ready:function(){for(var a=this._boundLogics,b=0,c=a.length;b<c;b++)this._logicInfoController.appendTargetToList(a[b]);this._logicboundEventBound=!0;this._traceLogController.setInfoControllers([this._controllerInfoController,this._logicInfoController])},"{this.targetWindow.document} h5devtoolLogicbound":function(a){this._logicInfoController.appendTargetToList(a.evArg)},"{this.targetWindow.document} h5controllerbound":function(a){a.evArg.__name&&this._controllerInfoController.appendTargetToList(a.evArg)},
"{this.targetWindow.document} h5controllerunbound":function(a){this._controllerInfoController.removeTargetList(a.evArg)},"{document} keydown":function(a){116===a.event.keyCode&&A&&a.event.preventDefault()},".left click":function(a,b){a.event.target===b[0]&&this.trigger("leftclick")},"{.h5devtool-controllBtn.opencloseBtn.closeTool} click":function(a,b){b.text("▼").removeClass("closeTool").addClass("openTool");e(".h5devtool-controllBtn").not(b).css("display","none");e(this.rootElement).css("display",
"none");this.trigger("close")},"{.h5devtool-controllBtn.opencloseBtn.openTool} click":function(a,b){b.text("×").removeClass("openTool").addClass("closeTool");e(".h5devtool-controllBtn").not(b).css("display","inline-block");e(this.rootElement).css("display","block");e(".h5devtool-controllBtn.showhideBtn.showTool").trigger("click");this.trigger("open")},"{.h5devtool-controllBtn.showhideBtn.hideTool} click":function(a,b){b.text("↓").removeClass("hideTool").addClass("showTool");A||e(this.rootElement).css({display:"none"})},
"{.h5devtool-controllBtn.showhideBtn.showTool} click":function(a,b){b.text("↑").removeClass("showTool").addClass("hideTool");A||e(this.rootElement).css({display:""})}};h5.core.expose(ba);Q.info("hifive Developer Tool(ver.{0})の読み込みが完了しました。",R);var z=null,t=null,r={target:"*",interceptors:h5.u.createInterceptor(function(a,b){var c=a.target;if(N||!c.__name||h5.u.str.startsWith(c.__name,"h5.devtool"))return a.proceed();var d=a.funcName,f=p(c);f.indentLevel=f.indentLevel||0;var h=f.methodCount;h||(h=new B(c),
f.methodCount=h);h.count(d);var h=f.indentLevel,g="",g=-1!==d.indexOf(" ")&&c.__controllerContext?"event":-1!==e.inArray(d,q)&&c.__controllerContext?"lifecycle":0===d.indexOf("_")?"private":"public";b.beginLog=[];f.devtoolLog||(f.devtoolLog=w());if(z&&z!==c&&t){var k=L(c,c.__name+"#"+d,g,"BEGIN","",t.indentLevel);u(t.devtoolLog,k);t.indentLevel+=1;b.beginLog.push({target:z,logObj:k})}k=L(c,d,g,"BEGIN","",h);b.logObj=k;u(f.devtoolLog,k);f.indentLevel+=1;b.beginLog.push({target:c,logObj:k});d=L(c,c.__name+
"#"+d,g,"BEGIN","",C);C++;u(O,d);b.wholeLog=d;z=c;t=f;return a.proceed()},function(a,b){var c=a.target;if(!N&&c.__name&&!h5.u.str.startsWith(c.__name,"h5.devtool")){c=p(c);c.indentLevel=c.indentLevel||0;var d=a.result,c=d&&e.isFunction(d.promise)&&!h5.u.obj.isJQueryObject(d)&&e.isFunction(d.done)&&e.isFunction(d.fail),f="",h="END";c&&(h="DFD","resolved"===d.state()?f="(RESOLVED)":"rejected"===d.state()&&(f="(REJECTED)"));d=K(new Date);if(b.beginLog)for(var g=0,k=b.beginLog.length;g<k;g++){var m=b.beginLog[g].target,
n=e.extend({},b.beginLog[g].logObj);n.tag=h;n.promiseState=f;n.time=d;n.indentWidth=c?0:n.indentWidth;u(p(m).devtoolLog,n);p(m).indentLevel-=1}g=e.extend({},b.wholeLog);g.tag=h;g.promiseState=f;g.time=d;g.indentWidth=c?0:g.indentWidth;u(O,g);C-=1;t=z=null}}),pointCut:"*"};P(r);h5.settings.aspects=[r];e(function(){F().done(function(a){s=a;h5.core.controller(e(a.document).find(".h5devtool"),ba,{win:a,traceLogs:O,loggerArray:D}).readyPromise.done(function(){var b=this;Z(a,"unload",function(){b._controllerInfoController.removeOverlay(!0);
b.dispose();N=!0});a!=window&&Z(window,"unload",function(){a.close()})})}).fail(function(a){"block"===a&&alert("[hifive Developer Tool]\n別ウィンドウのオープンに失敗しました。ポップアップブロックを設定している場合は一時的に解除してください。")})})}})(jQuery);